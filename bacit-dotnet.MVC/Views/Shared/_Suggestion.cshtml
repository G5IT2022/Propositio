@using System.Security.Claims
@using bacit_dotnet.MVC.Entities
@using bacit_dotnet.MVC.Models.Suggestion;
@model SuggestionEntity;

<div class="container sugg-container">
    <div class="row sugg-info">
        <div class="col-6">Forfatter: @Model.author.name Ansvarlig: @Model.responsible_employee.name</div>
        <div class="col-2">
            @foreach (var team in Model.author.teams)
            {
                @(team.team_name += " ")
                ;
            }
        </div>

        <div class="col-1 @Model.status"></div>
        <div class="col-1">@Model.status</div>
        <!--Sjekker om brukeren er en teamlead eller admin før den viser knappen for markering av forslag-->
        <!--Man må dele strengen og velge det andre elementet for å kun få "admin" eller "user" osv-->
        @if (@Context.User.FindFirst(ClaimTypes.Role).ToString().Split(" ")[1].Equals("Admin") || @Context.User.FindFirst(ClaimTypes.Role).ToString().Split(" ")[1].Equals("TeamLead"))
        {
            <div class="col-1">
                @if (!Model.favorite)
                {
                    <a onclick="Fav(@Model.suggestion_id)">
                        <img src="/img/bootstrap-icons-1.9.1/bookmark-star.svg" alt="Bootstrap" width="24" height="24" id="@Model.suggestion_id" />
                    </a>
                }
                else
                {
                    <a onclick="Fav(@Model.suggestion_id)">
                        <img src="/img/bootstrap-icons-1.9.1/bookmark-star-fill.svg" alt="Bootstrap" width="24" height="24" id="@Model.suggestion_id" />
                    </a>
                }
            </div>
        }
        else
        {
            <div class="col-1">
                @if (!Model.favorite)
                {
                    <img src="/img/bootstrap-icons-1.9.1/bookmark-star.svg" alt="Bootstrap" width="24" height="24" id="@Model.suggestion_id" />

                }
                else
                {
                    <img src="/img/bootstrap-icons-1.9.1/bookmark-star-fill.svg" alt="Bootstrap" width="24" height="24" id="@Model.suggestion_id" />
                }
            </div>
        }
        <div class="col-1">
            @if (Model.images.Count > 0 && Model.images.ElementAt(0) != null)
            {
                <img src="/img/bootstrap-icons-1.9.1/paperclip.svg" alt="Bootstrap" width="24" height="24" id="@Model.suggestion_id" />

            }
        </div>
    </div>

    <!--Suggestion-info-->
    <div class="row">
        <div class="col-10">
            <p class="suggtitle">@Model.title</p>
            <p>@Model.description</p>
        </div>
        <div class="col-2"></div>
    </div>
    <hr />
    <!--Show categories for suggestion-->
    <div class="row test">
        <div class="col-8 categories">
            Kategorier:
            @foreach (var category in Model.categories)
            {
                @(category.category_name += " ")
                ;
            }
            <br>
            <div class="date">
                <span class="made">Opprettet: @Model.timestamp.createdTimestamp.ToString("dd/M/yyyy")</span>
                <br>
                <span class="due">Frist: @Model.timestamp.dueByTimestamp.ToString("dd/M/yyyy")</span>
            </div>
        </div>
        <br>
        <!--Button for Suggestion Details-->
        <div class="col-4">
            <br>
            <a class="buttonDetails" asp-controller="Suggestion" asp-action="Details" asp-route-id="@Model.suggestion_id">
                Vis mer
            </a>

        </div>
    </div>
</div>
<hr />
